---
title: "Phenomenal Eevee"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

# Introduction

Streaming platforms have taken the world by storm due to their convenience and ability to house innumerable popular television shows and movies. As these mediums continue to grow in popularity, discourse about them is also developing and is often centered around one primary question: Which platform is best? Throughout our data analysis, our team seeks to answer this aforementioned question to the best of our ability, taking an in-depth look at four mainstream services ---- Netflix, Amazon Prime Video, Hulu, and Disney+ ---- and the programs that have been present on the site throughout roughly the past two decades. Specifically, we use rankings developed by Rotten Tomatoes and hypothesis testing to approach two research questions: "Is the quality of exclusive shows different from non-exclusive shows in each respective platform?" and "Are exclusive shows' ratings different between the four platforms (Netflix, Hulu, Disney+, and Prime Video)?"

Regarding the first hypothesis, \[INSERT FINDINGS HERE\]. In terms of the second research question, our findings were in favor of the alternate hypothesis: there is some sort of difference in ratings between the exclusive shows on each of the four platforms.

# Data description

# Data analysis

```{r}
#| label: data-cleaning-for-exclusivity
library(tidyverse)
library(tidymodels)
library(dplyr)

tv_shows <- read_csv(file = "data/tv_shows.csv")

tv_shows_cleaned <- tv_shows |>
  mutate(Netflix = if_else(Netflix == 1, "Yes", "No"), 
         Hulu = if_else(Hulu == 1, "Yes", "No"),
         `Prime Video` = if_else(`Prime Video` == 1, "Yes", "No"),
         `Disney+` = if_else(`Disney+` == 1, "Yes", "No"),
         `Rotten Tomatoes` = str_remove(`Rotten Tomatoes`, "/100"),
         `Rotten Tomatoes` = parse_integer(`Rotten Tomatoes`)) |>
  mutate(exclusive_netflix = Netflix == "Yes" & Hulu == "No" & `Prime Video` == "No" & `Disney+` == "No",
         exclusive_hulu = Hulu == "Yes" & Netflix == "No" & `Prime Video` == "No" & `Disney+` == "No",
         exclusive_prime_video = `Prime Video` == "Yes" & Netflix == "No" & Hulu == "No" & `Disney+` == "No",
         exclusive_disney_plus = `Disney+` == "Yes" & Netflix == "No" & Hulu == "No" & `Prime Video` == "No")

tv_shows_cleaned


num_netflix_exclusive <- sum(tv_shows_cleaned$exclusive_netflix == TRUE)
num_hulu_exclusive <- sum(tv_shows_cleaned$exclusive_hulu == TRUE)
num_prime_video_exclusive <- sum(tv_shows_cleaned$exclusive_prime_video == TRUE)
num_disney_plus_exclusive <- sum(tv_shows_cleaned$exclusive_disney_plus == TRUE)

num_netflix_exclusive
num_hulu_exclusive
num_prime_video_exclusive
num_disney_plus_exclusive
```

```{r}
#| label: explaratory-data-analysis

tv_shows_cleaned_copy <- tv_shows_cleaned

netflix <- filter(tv_shows_cleaned_copy, Netflix == "Yes")
names(netflix)[7] <- "rotten_tomatoes"

netflix <- netflix |>
  select(Title, rotten_tomatoes) |>
  mutate(mean = mean(rotten_tomatoes)) |>
  mutate(platform = 'netflix') |>
  mutate(decile = 100) |>
  mutate(decile = ifelse(0<=rotten_tomatoes & rotten_tomatoes <=10, 
                         '1-10', decile)) |>
  mutate(decile = ifelse(10<rotten_tomatoes & rotten_tomatoes <=20, 
                         '11-20', decile)) |>
  mutate(decile = ifelse(20<rotten_tomatoes & rotten_tomatoes <=30, 
                         '21-30', decile)) |>
  mutate(decile = ifelse(30<rotten_tomatoes & rotten_tomatoes <=40, 
                         '31-40', decile)) |>
  mutate(decile = ifelse(50<rotten_tomatoes & rotten_tomatoes <=60, 
                         '51-60', decile)) |>
  mutate(decile = ifelse(60<rotten_tomatoes & rotten_tomatoes <=70, 
                         '61-70', decile)) |>
  mutate(decile = ifelse(70<rotten_tomatoes & rotten_tomatoes <=80, 
                         '71-80', decile)) |>
  mutate(decile = ifelse(80<rotten_tomatoes & rotten_tomatoes <=90, 
                         '81-90', decile)) |>
  mutate(decile = ifelse(90<rotten_tomatoes & rotten_tomatoes <=100, 
                         '91-100', decile))
  

hulu <- filter(tv_shows_cleaned_copy, Hulu == "Yes")
names(hulu)[7] <- "rotten_tomatoes"

hulu <- hulu |>
  select(Title, rotten_tomatoes) |>
  mutate(mean = mean(rotten_tomatoes)) |>
  mutate(platform = 'hulu') |>
  mutate(decile = 100) |>
  mutate(decile = ifelse(0<=rotten_tomatoes & rotten_tomatoes <=10, 
                         '1-10', decile)) |>
  mutate(decile = ifelse(10<rotten_tomatoes & rotten_tomatoes <=20, 
                         '11-20', decile)) |>
  mutate(decile = ifelse(20<rotten_tomatoes & rotten_tomatoes <=30, 
                         '21-30', decile)) |>
  mutate(decile = ifelse(30<rotten_tomatoes & rotten_tomatoes <=40, 
                         '31-40', decile)) |>
  mutate(decile = ifelse(50<rotten_tomatoes & rotten_tomatoes <=60, 
                         '51-60', decile)) |>
  mutate(decile = ifelse(60<rotten_tomatoes & rotten_tomatoes <=70, 
                         '61-70', decile)) |>
  mutate(decile = ifelse(70<rotten_tomatoes & rotten_tomatoes <=80, 
                         '71-80', decile)) |>
  mutate(decile = ifelse(80<rotten_tomatoes & rotten_tomatoes <=90, 
                         '81-90', decile)) |>
  mutate(decile = ifelse(90<rotten_tomatoes & rotten_tomatoes <=100, 
                         '91-100', decile))

names(tv_shows_cleaned_copy)[10] <- "prime_video"
prime <- filter(tv_shows_cleaned_copy, prime_video == "Yes")
names(prime)[7] <- "rotten_tomatoes"

prime <- prime |>
  select(Title, rotten_tomatoes) |>
  mutate(mean = mean(rotten_tomatoes)) |>
  mutate(platform = 'prime') |>
  mutate(decile = 100) |>
  mutate(decile = ifelse(0<=rotten_tomatoes & rotten_tomatoes <=10, 
                         '1-10', decile)) |>
  mutate(decile = ifelse(10<rotten_tomatoes & rotten_tomatoes <=20, 
                         '11-20', decile)) |>
  mutate(decile = ifelse(20<rotten_tomatoes & rotten_tomatoes <=30, 
                         '21-30', decile)) |>
  mutate(decile = ifelse(30<rotten_tomatoes & rotten_tomatoes <=40, 
                         '31-40', decile)) |>
  mutate(decile = ifelse(50<rotten_tomatoes & rotten_tomatoes <=60, 
                         '51-60', decile)) |>
  mutate(decile = ifelse(60<rotten_tomatoes & rotten_tomatoes <=70, 
                         '61-70', decile)) |>
  mutate(decile = ifelse(70<rotten_tomatoes & rotten_tomatoes <=80, 
                         '71-80', decile)) |>
  mutate(decile = ifelse(80<rotten_tomatoes & rotten_tomatoes <=90, 
                         '81-90', decile)) |>
  mutate(decile = ifelse(90<rotten_tomatoes & rotten_tomatoes <=100, 
                         '91-100', decile))

names(tv_shows_cleaned_copy)[11] <- "disney_plus"
disney <- filter(tv_shows_cleaned_copy, disney_plus == "Yes")
names(disney)[7] <- "rotten_tomatoes"

disney <- disney |>
  select(Title, rotten_tomatoes) |>
  mutate(mean = mean(rotten_tomatoes)) |>
  mutate(platform = 'disney') |>
  mutate(decile = 100) |>
  mutate(decile = ifelse(0<=rotten_tomatoes & rotten_tomatoes <=10, 
                         '1-10', decile)) |>
  mutate(decile = ifelse(10<rotten_tomatoes & rotten_tomatoes <=20, 
                         '11-20', decile)) |>
  mutate(decile = ifelse(20<rotten_tomatoes & rotten_tomatoes <=30, 
                         '21-30', decile)) |>
  mutate(decile = ifelse(30<rotten_tomatoes & rotten_tomatoes <=40, 
                         '31-40', decile)) |>
  mutate(decile = ifelse(50<rotten_tomatoes & rotten_tomatoes <=60, 
                         '51-60', decile)) |>
  mutate(decile = ifelse(60<rotten_tomatoes & rotten_tomatoes <=70, 
                         '61-70', decile)) |>
  mutate(decile = ifelse(70<rotten_tomatoes & rotten_tomatoes <=80, 
                         '71-80', decile)) |>
  mutate(decile = ifelse(80<rotten_tomatoes & rotten_tomatoes <=90, 
                         '81-90', decile)) |>
  mutate(decile = ifelse(90<rotten_tomatoes & rotten_tomatoes <=100, 
                         '91-100', decile))

total <- rbind(netflix, hulu)
total <- rbind(total,prime)
total <- rbind(total,disney)


total_per_platform <- total |>
  group_by(decile, platform) |>
  summarize(number = n())


mean_rankings <- data.frame(platform = c('Netflix',
                                         'Hulu','Amazon Prime',
                                         'Disney'),
                            mean=c(netflix[[3]][1], hulu[[3]][1],
                                   prime[[3]][1],  disney[[3]][1]))




total_per_platform |>
  ggplot(aes(x = decile, y = number, fill = platform)) +
  geom_bar(position = "fill", stat = "identity") +
  scale_color_viridis_d(option = "D", end = 0.8) +
  theme_minimal() +
  labs(
    title = "Percent of shows that fall under a given decile for each platform",
      x = "Decile", y = "Fraction of shows", 
    fill = "Platforms", disnay = "Disney+") +
  scale_fill_discrete(labels = c("Disney+", "Hulu",
                                 "Netflix", "Prime Video"))
  


total |>
  ggplot(aes(x = platform, y = rotten_tomatoes)) + 
  geom_boxplot() +
  labs(title = "Ratings of Streamed Shows by Platform", 
       x = "Platforms", y = "Show Ratings")



mean_rankings |>
  ggplot(aes(x = platform, y = mean)) + ylim(c(0, 100)) +
  geom_bar(stat = "identity") +
  labs(title = "Ratings of Streamed Shows by Platform",
       x = "Platforms", y = "Mean Ratings")


```

#### ***First Analysis: Hypothesis Test***

**Research Question:** Is the quality of exclusive shows different from non-exclusive shows in a specific platform, for each platform separately?

**Null Hypothesis**: The proportion of high-rated exclusive shows (defined as having a rating above a certain threshold) is equal to or less than the proportion of high-rated non-exclusive shows across all four platforms.

$$
H_0: \mu_{exclusive} < \mu_{non-exclusive}
$$

Alternative Hypothesis: The proportion of high-rated exclusive shows is greater than the proportion of high-rated non-exclusive shows across all four platforms.

$$
H_0: \mu_{exclusive} > \mu_{non-exclusive}
$$

```{r}
#|label: hypothesis-testing-analysis-1-multivariable

names(tv_shows_cleaned_copy)[7] <- "rotten_tomatoes"

observed_fit <- tv_shows_cleaned_copy |>
  specify(rotten_tomatoes ~ Netflix + Hulu + disney_plus + prime_video) |>
  fit()

observed_fit

null_fits <- tv_shows_cleaned_copy |>
  specify(rotten_tomatoes ~ Netflix + Hulu + disney_plus + prime_video) |>
  hypothesize(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
  fit()

ci <- get_confidence_interval(
  x = null_fits,
  point_estimate = observed_fit,
  level = 0.95
)

print(ci)

get_p_value(
  x = null_fits,
  obs_stat = observed_fit,
  direction = "less"
)

```

**Interpretation: point-estimate**

The intercept of 35.45341513 shows the estimated average Rotten Tomatoes rating for a show that is non-exclusive for any of the four platforms.

The coefficients for `NetflixYes`, `HuluYes`, `disney_plusYes`, and `prime_videoYes` represent the estimated differences in Rotten Tomatoes ratings that are exclusive to each platform compared to non-exclusive. The 17.02 coefficient for `NetflixYes` shows that shows exclusive to Netflix have an estimated average Rotten Tomato ratings higher by 17.02 points than ratings non-exclusive to Netflix. Similarly, the coefficient of `HuluYes` shows that shows exclusive to Hulu have an average of 15.79 points higher ratings in Rotten Tomatoes than non0exclusive shows. The coefficient of `disney_plusYes` shows that shows exclusive to Disney+ have an average of 11.86 points higher Rotten Tomato ratings than non-exclusive shows. Finally, the coefficient of `prime_videoYes` shows that the shows exclusive to Prime Video have an average of 0.07 points lower ratings in Rotten Tomatoes than shows non-exclusive to Prime Video.

**Interpretation: confidence intervals**

The 95% confidence intervals for observing similar results in the population for shows exclusive to either Hulu, Netflix, Diney+, or Prime Video are

-   \[-2.026, 1.82\] for `HuluYes`

-   \[-2.01, 1.83\] for `NetflixYes`

-   \[-2.56, 2.43\] for `disney_plusYes`

-   \[-2.07, 1.89\] for `prime_videoYes`

Because all the above confidence intervals include 0 in their interval we cannot confidently rule out the possibility that shows exclusive the given platform do not have a significant influence on Rotten Tomatoes ratings.

The 95% confidence interval \[45.36, 49.26\] for the intercept shows that we can be confident that the average Rotten Tomato rating observed in real population falls into the observed range.

#### ***Second Analysis: Hypothesis Test***

**Research Question:** Are exclusive shows' ratings different between the four platforms (Netflix, Hulu, Disney+, and Prime Video)?

**Null Hypothesis**: There is no difference in quality of the exclusive shows between the four platforms.

$$
H_0: μ1 = μ2 = μ3 = μ4
$$

**Alternate Hypothesis:** There is a difference in quality of the exclusive shows between the four platforms.

$$
H_A: μ1 ≠ μ2 ≠ μ3 ≠ μ4
$$

```{r}
#| label: multivariate-hypothesis

library(forcats)

tv_shows_exclusive <- tv_shows_cleaned |>
  pivot_longer(cols = c(exclusive_netflix, exclusive_hulu, exclusive_disney_plus, exclusive_prime_video), values_to = "bool", names_to = "shows") |>
  filter(bool == TRUE) |>
  mutate(shows = fct_relevel(.f = shows, "exclusive_netflix"))

set.seed(123)
observed_fit <- tv_shows_exclusive |>
  specify(`Rotten Tomatoes` ~ shows) |>
  fit()

null_fits <- tv_shows_exclusive |>
  specify(`Rotten Tomatoes` ~ shows) |>
  hypothesize(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
  fit()

get_confidence_interval(
  x = null_fits,
  point_estimate = observed_fit,
  level = .95)

get_p_value(
  x = null_fits,
  obs_stat = observed_fit,
  direction = "two sided"
)
```

# Evaluation of significance

# Interpretation and conclusions

# Limitations

The first limitation is that our study right now just focuses on the quality of exclusive shows based on their rating scores (Rotten Tomatoes), which may not be a comprehensive measure of the quality of exclusive shows or non-exclusive shows on each platform. The analysis's focus on Rotten Tomatoes ratings alone may not fully capture the perceived quality of exclusive shows on each platform. Moreover, considering the ratings of exclusive shows and not non-exclusive shows could limit the overall understanding of the quality of each platform's content.

The second limitation is that we could not find any reliable and consistent dataset for the popularity, preferences, viewerships, viewing rates, or the number of subscribers of each platform, which could also affect the audiences' perceived quality and critical reception, limiting our study to find the relationship between the quality of exclusive shows or non-exclusive shows and the preference of platforms. This is a result of the competitiveness in the streaming industry. Companies' revenue almost entirely depends on subscriptions, and some of them are less active in publishing them. Additionally, some of the viewership data we find are using different metrics and, therefore, cannot be used to generate inferences.

The third limitation of our study is that there are unbalanced amounts of exclusive shows on each platform; for example, Netflix has significantly larger data of exclusive shows compared to the other platforms, which may affect the overall quality comparison between platforms. Disney Plus is a relatively new platform and has a smaller library of exclusive shows, which may limit the analysis. These unbalanced amounts of exclusive shows on each platform may introduce bias and affect the conclusions we can draw from our analyses.

The fourth limitation is that our analysis plan uses tomato scores to represent quality. This definition could have some biases. Firstly, the tomato score is a critics rating rather than an audience rating. Many movies and shows have a target audience that is better or worse represented than the other. Critics might inadvertently bring bias into their rating, and subsequently, our definition of quality could be biased as well. In addition, some shows that are watched by fewer people are less rated with tomato score, making the score easily influenced by a few critics, and therefore create bias in the definition of quality.

The fifth limitation is that our analysis does not account for the different types or genres of exclusive shows on each platform, such as comedies, documentaries, actions, etc., which may have different average ratings. We would have better insights if we had more data about the genres to compare shows of similar types across platforms rather than just looking at the overall average ratings.

# Acknowledgments

Thanks to this user who published the dataset we are using on Kraggle:

<https://www.kaggle.com/datasets/ruchi798/tv-shows-on-netflix-prime-video-hulu-and-disney>

\
